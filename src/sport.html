<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>

<body>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script> 
    <div id="top">
        <section id="bar">
            <h1 id="title" >
                <a href="index.html">Bambus</a> <!-- plus nejaka ikonka  -->
            </h1>
            <div class="container">
                <button type="submit" class="btn" onclick="addopenPopup()">
                    Pridať svoj podnik
                </button>
                <div class="popup" id="add_popup">
                    <h2>Pridať svoj podnik</h2>
                    <form id="add_form">
                        <div class="input-category">
                            <input id="category-sport" name="category" type="radio" value="sport"/>
                            <label class="inline" for="category-sport">Šport</label>
                            
                            <input id="category-beauty" name="category" type="radio" value="beauty"/>
                            <label class="inline" for="category-beauty">Krása</label>
                            
                            <input id="category-regeneration" name="category" type="radio" value="regeneration"/>
                            <label class="inline" for="category-regeneration">Regenerácia</label>
                        </div>
                        <div class="regeneration selectt">
                            <input id="subcategory-wellness" name="subcategory" type="radio" value="wellness"/>
                            <label class="inline" for="subcategory-wellness">Wellness</label>
                            
                            <input id="subcategory-massage" name="subcategory" type="radio" value="massage"/>
                            <label class="inline" for="subcategory-massage">Masáže</label>
                            
                            <input id="subcategory-sauna" name="subcategory" type="radio" value="sauna"/>
                            <label class="inline" for="subcategory-sauna">Sauny</label>
                        </div>
                        <div class="sport selectt">
                            <input id="subcategory-letne_sporty" name="subcategory" type="radio" value="letne_sporty"/>
                            <label class="inline" for="subcategory-letne_sporty">Letné športy</label>
                            
                            <input id="subcategory-zimne_sporty" name="subcategory" type="radio" value="zimne_sporty"/>
                            <label class="inline" for="subcategory-zimne_sporty">Zimné športy</label>
                            
                            <input id="subcategory-vodne_sporty" name="subcategory" type="radio" value="vodne_sporty"/>
                            <label class="inline" for="subcategory-vodne_sporty">Vodné športy</label>
                        </div>
                        <div class="beauty selectt">
                            <input id="subcategory-barber" name="subcategory" type="radio" value="barber"/>
                            <label class="inline" for="subcategory-barber">Holičstva</label>
                            
                            <input id="subcategory-nechty" name="subcategory" type="radio" value="nechty"/>
                            <label class="inline" for="subcategory-nechty">Starostlivosť o nechty</label>
                            
                            <input id="subcategory-solarko" name="subcategory" type="radio" value="solarko"/>
                            <label class="inline" for="subcategory-solarko">Solaria</label>
                        </div>
                        <div id="input_data">
                            <input autocomplete="off" type="text" name="title">
                            <input autocomplete="off" type="text" name="text">
                        </div>
                        
                        <script type="text/javascript">
                            $(document).ready(function() {
                                $('input[name="category"]').click(function() {
                                    var inputValue = $(this).attr("value");
                                    var targetBox = $("." + inputValue);
                                    $(".selectt").not(targetBox).hide();
                                    $(targetBox).show();
                                });
                            });
                        </script>
                        
                        <button type="submit" onclick=addclosePopup()>Pridať</button>
                    </form>
                    <script>
                        
                        function handleFormSubmit(event) {
                            event.preventDefault();
                            
                            const data = new FormData(event.target);
                            
                            const formJSON = Object.fromEntries(data.entries());

                        
                            var results = JSON.stringify(formJSON);
                            SaveDataToLocalStorage(formJSON);
                            
                            window.location.reload();
                        }
                        
                        

                            function SaveDataToLocalStorage(data)
                            {
                                var a = [];
                                a = JSON.parse(localStorage.getItem('session')) || [];
                                a.push(data);
                                localStorage.setItem('session', JSON.stringify(a));
                            }

                            function createElements(obj) {
                                
                                const mainDiv = document.createElement('div');
                                mainDiv.classList.add('video-preview');
                                const img = document.createElement('img');
                                img.classList.add('thumbnail');
                                img.src='massage.jpeg';
                                const title = document.createElement('h2');
                                title.classList.add('blog-title');
                                title.innerHTML = obj['title'];
                                const text = document.createElement('p');
                                text.classList.add('blog-text');
                                text.innerHTML = obj['text'];
                                mainDiv.appendChild(img);
                                mainDiv.appendChild(title);
                                mainDiv.appendChild(text);
                               
                                document.getElementById(obj['subcategory']).appendChild(mainDiv);
                                
                            }
                            
                            function deleteElements(){
                                d_div.remove();
                            }

                        const form = document.querySelector('#add_form');
                        form.addEventListener('submit', handleFormSubmit);
                            
                    </script>
                    
                    
                </div>
                <button type="submit" class="btn" onclick="openPopup()">
                    Prihlásiť sa
                </button>
                <div class="popup" id="popup">
                    <h2>Prihlasiť sa</h2>
                    <p>Nemáte účet? <span class="Registrovat_sa">Registrovať sa</span></p>
                    <form class="login_form" action="home.html" method="post" name="form" onsubmit="return validated()">
                        <div class="font">Email alebo tel. číslo</div>
                        <input autocomplete="off" type="text" name="email">
                        <div class="font font2">Heslo</div>
                        <input type="password" name="password">
                    </form>
                    <form action="profil.html">
                        <button type="submit" onclick=closePopup()>Prihlásiť sa</button>
                    </form>
                </div>
            </div>
            <script src="valid.js"></script>
        </section>

        <section id="menu">
            <ul>
                <li><a href="index.html">Domov</a></li>
                <li>
                    <a href="sport.html">Šport</a>
                    <ul class="dropdown">
                        <li><a href="sport.html#zimne_sporty">Zimné športy</a></li>
                        <li><a href="sport.html#letne_sporty">Letné športy</a></li>
                        <li><a href="sport.html#vodne_sporty">Vodné športy</a></li>
                    </ul>
                </li>
                <li>
                    <a href="beauty.html">Krása</a>
                    <ul class="dropdown">
                        <li><a href="">Podkategoria</a></li>
                        <li><a href="">Podkategoria</a></li>
                        <li><a href="">Podkategoria</a></li>
                    </ul>
                </li>
                <li>
                    <a href="regeneration.html">Regenerácia</a>
                    <ul class="dropdown">
                        <li><a href="regeneration.html#wellness">Wellness</a></li>
                        <li><a href="regeneration.html#massage">Masáže</a></li>
                        <li><a href="regeneration.html#sauna">Sauny</a></li>
                    </ul>
                </li>
            </ul>
        </section>

    </div>
    <div id="mid">
        <section id="right_side">
            <div  id="map">
                <script src="map_init.js"></script>
                <script async
                    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyA_jFvlb3oQ-FiBNlzbc5jmDuQsB0IhKJc&callback=initMap">
                </script>
            </div> 
        </section>
        <section id="left_side">
            <section id="zimne_sporty">
                <h2>Zimné športy</h2>
            </section>

            <section id="letne_sporty">
                <h2>Letné športy</h2>
            </section>
            <section id="vodne_sporty">
                <h2>Vodné športy</h2>
            </section>
        </section>
    </div>
    <div id="bottom">
        <!-- nejaky list kontaktov-->
        <h2 style="margin: 5px">Kontaktujte nas</h2>
        <p style="margin: 5px">CZ tel. číslo: +420 111 111 111</p>
        <p style="margin: 5px">SK tel. číslo: +421 222 222 222</p>
        <p style="margin: 5px"> email: info@bambus.cz</p>
        <p style="margin: 5px">adresa: Božetěchova 1/2, 612 00 Brno-Královo Pole</p>
    </div>

<script>
let popup = document.getElementById("popup");
function openPopup(){
    popup.classList.add("open-popup");
}
function closePopup(){
    popup.classList.remove("open-popup");
} 


let add_popup = document.getElementById("add_popup");
function addopenPopup(){
    add_popup.classList.add("open-popup");
}
function addclosePopup(){
    add_popup.classList.remove("open-popup");
}

function mapChange(adresos){
    // premenna adresa sa prisposobi pre http request
    adresos.split(" ").join("%20");
    const Http = new XMLHttpRequest();
    const url='https://maps.googleapis.com/maps/api/geocode/json?address=' + adresos + '&key=AIzaSyA_jFvlb3oQ-FiBNlzbc5jmDuQsB0IhKJc';

    getJSON(url,
    function(err, data) {
    if (err !== null) {
        alert('Something went wrong: ' + err);
    } else {
        var latitude =  Number(data.results[0].geometry.location.lat);
        var length = Number(data.results[0].geometry.location.lng);
        var options = {
            zoom:14,
            center:{lat:latitude,lng:length}
        }
        var map = new google.maps.Map(document.getElementById('map'), options)
        var marker = new google.maps.Marker({
            position: {lat:latitude,lng:length},
            map: map
        });
    }
    });
} 

</script>
<script>
    var myData = JSON.parse(localStorage.getItem('session'));
    console.log(myData);

                            //var d_div = document.getElementById('.card');
                            //deleteElements();

    myData.forEach(obj => {
        console.log(obj['subcategory']);
        console.log(obj);
        createElements(obj);
    });


    window.addEventListener("storage", handler);

    function handler() {
        location.reload();
    }
</script>
</body>
</html>