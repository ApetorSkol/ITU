<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Document</title>
</head>

<body  onload="checkProfile()">
    <script type="module">
        "use strict";
        import users from './user.json' assert {type: 'json'};

        
        for(let i = 0; i < users.length; i++){
            localStorage.setItem("correct_email" + i, users[i]["email"]);
        }

    </script>
    
    <div id="top">
        <section id="bar">
            <h1 id="title" >
                <a href="index.html">Bambus</a> <!-- plus nejaka ikonka  -->
            </h1>
            <div class="container">
                <button type="submit" id="btn" class = "btn" onclick="openPopup()">
                    Odhlásiť sa
                </button>
                <div class="popup" id="popup">
                    <h2>Boli ste odhlásený</h2>
                    <form action="index.html">
                        <button type="submit" onclick=closePopup()>Pokračovať</button>
                    </form>
                </div>
            </div>
        </section>

        <section id="menu">
            <ul>
                <li><a href="index.html">Domov</a></li>
                <li>
                    <a href="sport.html">Šport</a>
                    <ul class="dropdown">
                        <li><a href="">Zimné športy</a></li>
                        <li><a href="">Letné športy</a></li>
                        <li><a href="">Vodné športy</a></li>
                    </ul>
                </li>
                <li>
                    <a href="beauty.html">Krása</a>
                    <ul class="dropdown">
                        <li><a href="">Holičstvá</li>
                        <li><a href="">Starostlivosť o nechty</a></li>
                        <li><a href="">Solaria</a></li>
                    </ul>
                </li>
                <li>
                    <a href="regeneration.html">Regenerácia</a>
                    <ul class="dropdown">
                        <li><a href="regeneration.html#wellness">Wellness</a></li>
                        <li><a href="regeneration.html#massage">Masáže</a></li>
                        <li><a href="regeneration.html#sauna">Sauny</a></li>
                    </ul>
                </li>
                <li>
                    <a href="profil.html" class="profil_btn">Profil</a>
                </li>
            </ul>
        </section>

    </div>
    <div id="mid">
        <section id="right_side">
            <div class="">
                <h1 class="">Údaje</h1>
                <div class="">
                    
                    <div class="card-body">
                        <div class="row">
                            <div >
                                <h3>Full Name</h3>
                            </div>
                            <div id="Meno">

                            </div>
                        </div>

                        <div class="row">
                            <div >
                                <h3>Email</h3>
                            </div>
                            <div id="email">

                            </div>
                        </div>

                        <div class="row">
                            <div >
                                <h3>Phone</h3>
                            </div>
                            <div id="tel_cislo">

                            </div>
                        </div>
                        <div class="row">
                            <div >
                                <h3>Adresa</h3>
                            </div>
                            <div id="bydlisko">

                            </div>
                        </div>
                        <div class="Rezervacie">
                            <h1 class="Rezervacie-title">Rezervacie</h1>
                            <hr>
                            <div class="card-body">
                                <div class="row">

                                    <h3 id="first_res">

                                    </h3>
                                    <div id="first_info">

                                    </div>
                                    <h3 id="second_res">

                                    </h3>
                                    <div id="second_info">

                                    </div>
                                    <h3 id="third_res">

                                    </h3>
                                    <div id="third_info">

                                    </div>
                                    <h3 id="fourth_res">

                                    </h3>
                                    <div id="fourth_info">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="left_side">
            <div class="row">
                <div class="card text-center sidebar">
                    <div class="card-body">
                        <img src="Pictures/image.jpg" class="rounded-circle" width="250">
                        <div class="nastavenia">
                            <hr>
                            <a href="">Upraviť profil</a>
                            <a href="">Upraviť rezervácie</a>
                            <a href="">Registrovať pobočku</a>
                            <a href="">Podpora</a>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        
        <div class = "cont">
            <div class="main">
                
                
            </div>
        </div>

    </div>
    

    <div id="bottom">
        <!-- nejaky list kontaktov-->
        <h2 style="margin: 5px">Kontaktujte nas</h2>
        <p style="margin: 5px">CZ tel. číslo: +420 111 111 111</p>
        <p style="margin: 5px">SK tel. číslo: +421 222 222 222</p>
        <p style="margin: 5px"> email: info@bambus.cz</p>
        <p style="margin: 5px">adresa: Božetěchova 1/2, 612 00 Brno-Královo Pole</p>
    </div>

<script>

let popup = document.getElementById("popup");
function openPopup(){
    popup.classList.add("open-popup");
    var tlacidlo = document.getElementById("btn");
    localStorage.removeItem("flag");
    tlacidlo.onclick = logout;
    
}
function closePopup(){
    popup.classList.remove("open-popup");
}

function checkProfile(){  
    var uzivatel = localStorage.getItem('flag');

    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {

            var uzivatelia = JSON.parse(xhttp.responseText);
            
            console.log(uzivatelia);

            var meno_priezvisko = document.getElementById("Meno");
            meno_priezvisko.innerHTML = uzivatelia["meno"] + " " +uzivatelia["priezvisko"];

            var meno_priezvisko = document.getElementById("email");
            meno_priezvisko.innerHTML = uzivatelia["email"];

            var meno_priezvisko = document.getElementById("tel_cislo");
            meno_priezvisko.innerHTML = uzivatelia["phoneNumbers"];

            var meno_priezvisko = document.getElementById("bydlisko");
            meno_priezvisko.innerHTML = " ";

            for(let i = 0; i < uzivatelia["rezervacie"].length; i++){
                var reserv = JSON.stringify(uzivatelia["rezervacie"][i]["nazov-title"]);
                var inform = JSON.stringify(uzivatelia["rezervacie"][i]["adresa"]) + "\n" +JSON.stringify(uzivatelia["rezervacie"][i]["datum"]);
                reservation = reserv.replaceAll('"', '');
                information = inform.replaceAll('"', '');
                if (i == 0){
                    var res = document.getElementById("first_res");
                    var info = document.getElementById("first_info");
                    
                    res.innerHTML = reservation;
                    info.innerHTML = information;
                }
                if (i == 1){
                    var res = document.getElementById("second_res");
                    var info = document.getElementById("second_info");
                    
                    res.innerHTML = reservation;
                    info.innerHTML = information;
                }
                if (i == 2){
                    var res = document.getElementById("third_res");
                    var info = document.getElementById("third_info");
                    
                    res.innerHTML = reservation;
                    info.innerHTML = information;
                }
                if (i == 3){
                    var res = document.getElementById("fourth_res");
                    var info = document.getElementById("fourth_info");
                    
                    res.innerHTML = reservation;
                    info.innerHTML = information;
                }


            }
        }
    };
    xhttp.open("POST", "https://itucko-5mig.onrender.com/prihlasenie", true);
    xhttp.send(uzivatel);

    


}
setInterval(checkProfile, 5000); // Send request every 1000 milliseconds (1 second)
</script>


</body>
</html>
